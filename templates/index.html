<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>InforMax</title>
  <style>
    :root{
      --bg:#f3f4f6;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --btn:#111827;
      --btnText:#ffffff;
      --border:#e5e7eb;
      --shadow: 0 10px 30px rgba(2,6,23,.12);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: var(--bg);
      color: var(--text);
    }
    .wrap{
      min-height: 100vh;
      padding: 16px;
      padding-bottom: calc(16px + env(safe-area-inset-bottom));
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .card{
      width: min(720px, 100%);
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
    }
    h1{
      margin: 0 0 8px 0;
      font-size: 22px;
      letter-spacing: .2px;
    }
    .sub{
      margin:0 0 12px 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
    }
    textarea{
      width:100%;
      min-height: 180px;
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
      font-size: 16px;
      line-height: 1.35;
      resize: vertical;
      outline: none;
    }
    textarea:focus{border-color:#cbd5e1}
    .row{
      display:flex;
      gap: 10px;
      margin-top: 12px;
      flex-wrap: wrap;
    }
    button{
      width: 100%;
      border:0;
      border-radius: 14px;
      padding: 14px 16px;
      font-size: 16px;
      font-weight: 600;
      background: var(--btn);
      color: var(--btnText);
      cursor: pointer;
      touch-action: manipulation;
    }
    button:disabled{opacity:.6; cursor:not-allowed}
    .out{
      margin-top: 12px;
      background: #0b1220;
      color: #e5e7eb;
      border-radius: 14px;
      padding: 12px;
      min-height: 110px;
      white-space: pre-wrap;
      word-break: break-word;
      font-size: 15px;
      line-height: 1.4;
    }
    .hint{
      margin-top: 10px;
      font-size: 12px;
      color: var(--muted);
    }
    .tools{
      display:flex;
      gap: 10px;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    .ghost{
      background: transparent;
      color: var(--text);
      border: 1px solid var(--border);
      font-weight: 600;
    }

    /* Мобильная оптимизация */
    @media (max-width: 420px){
      .card{padding: 14px}
      textarea{min-height: 220px}
      h1{font-size: 20px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>InforMax</h1>
      <p class="sub">Вставь сообщение руководителя (можно с «эээ» и ошибками) — получишь чистую деловую версию.</p>

      <textarea id="q" placeholder="Напиши сюда сообщение руководителя…"></textarea>

      <div class="row">
        <button id="btn">Сделать красиво</button>
      </div>

      <div class="tools">
        <button id="copy" class="ghost" type="button">Копировать результат</button>
        <button id="clear" class="ghost" type="button">Очистить</button>
      </div>

      <div id="out" class="out">Результат появится здесь</div>

      <div class="hint">Совет: эту ссылку можно закрепить в группе MAX как “мини-приложение”.</div>
    </div>
  </div>

<script>
  const btn = document.getElementById("btn");
  const q = document.getElementById("q");
  const out = document.getElementById("out");
  const copy = document.getElementById("copy");
  const clear = document.getElementById("clear");

  btn.onclick = async () => {
    const text = q.value.trim();
    if (!text) return;

    btn.disabled = true;
    btn.textContent = "Думаю…";
    out.textContent = "Обрабатываю…";

    try {
      const r = await fetch("/generate", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ text })
      });
      const j = await r.json();
      out.textContent = j.result || "Нет ответа";
    } catch (e) {
      out.textContent = "Ошибка связи с сервером";
    } finally {
      btn.disabled = false;
      btn.textContent = "Сделать красиво";
    }
  };

  copy.onclick = async () => {
    try {
      await navigator.clipboard.writeText(out.textContent);
      copy.textContent = "Скопировано ✅";
      setTimeout(()=>copy.textContent="Копировать результат", 1200);
    } catch {
      copy.textContent = "Не получилось";
      setTimeout(()=>copy.textContent="Копировать результат", 1200);
    }
  };

  clear.onclick = () => {
    q.value = "";
    out.textContent = "Результат появится здесь";
    q.focus();
  };
</script>
</body>
</html>
