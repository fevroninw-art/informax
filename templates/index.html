<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>InforMax</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:0;background:#f5f6f8}
    .wrap{max-width:720px;margin:0 auto;padding:16px}
    .card{background:#fff;border-radius:16px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.08)}
    h1{margin:0 0 12px;font-size:22px}
    textarea{width:100%;min-height:160px;padding:12px;border-radius:12px;border:1px solid #ddd;resize:vertical;font-size:16px}
    button{width:100%;margin-top:10px;padding:12px;border-radius:12px;border:0;font-size:16px;cursor:pointer}
    .out{margin-top:12px;padding:12px;border-radius:12px;background:#0b1220;color:#e8eefc;white-space:pre-wrap;word-break:break-word;min-height:72px}
    .small{color:#666;font-size:12px;margin-top:10px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>InforMax</h1>
      <div class="small">Надиктуй / вставь текст → получи чистую деловую версию.</div>

      <textarea id="t" placeholder="Напиши сюда сообщение руководителя (можно с 'эээ' и ошибками)"></textarea>
      <button id="b">Сделать красиво</button>

      <div id="out" class="out">Результат появится здесь</div>
    </div>
  </div>

<script>
const t = document.getElementById('t');
const b = document.getElementById('b');
const out = document.getElementById('out');

b.onclick = async () => {
  const text = t.value.trim();
  if(!text){ out.textContent = "Напиши текст."; return; }

  b.disabled = true;
  b.textContent = "Обрабатываю...";
  out.textContent = "";

  try{
    const r = await fetch('/generate', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({text})
    });

    const j = await r.json();
    if(!r.ok){
      out.textContent = "Ошибка: " + (j.error || "неизвестно");
    } else {
      out.textContent = j.result || "Пустой ответ";
    }
  }catch(e){
    out.textContent = "Ошибка связи с сервером";
  }finally{
    b.disabled = false;
    b.textContent = "Сделать красиво";
  }
}
</script>
</body>
</html>
